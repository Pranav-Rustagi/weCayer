<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel="shortcut icon" href="imgs/weCayer-logo.png" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>weCayer</title>

    <!-- BOOTSTRAP CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

    <!-- BOOTSTRAP jQuery and JS bundle w/ Popper.js -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
        crossorigin="anonymous"></script>

    <!-- Google fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600&family=Roboto:wght@300;400&family=Courgette&display=swap"
        rel="stylesheet">

    <!-- font swesome -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
        integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!-- jquery -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

    <!-- custom css -->
    <link rel="stylesheet" href="style.css">

</head>

<body>

    <!-- navigation bar -->
    <section class="m-0">
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark flex-column">
            <a class="navbar-brand m-0" href="./">
                <img src="imgs/weCayer-logo.png" height="28px" alt="">
                weCayer
            </a>

            <div>
                <ul class="navbar-nav flex-row">
                    <li class="nav-item mr-5 active">
                        <a class="nav-link" href="">My page</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link pr-0" data-action="logout" href="">Log out</a>
                    </li>
            </div>
        </nav>
    </section>

    <!-- content block -->
    <section id="helper" data-applied="helper">
        <h1 class="section-title bg-dark text-light text-center font-weight-normal">Customer Validation :</h1>
        <div id="contentBlock" class="row flex-column text-light mx-auto col-lg-5 col-md-8 col-sm-10 p-3">
            <h1 class="h1 px-3 mb-5 font-weight-normal text-uppercase text-center">Enter details</h1>
            <form>
                <div class="form-group row m-0 px-3">
                    <label for="aadhar" class="col-sm-4 col-md-3 col-form-label px-0">Aadhar Number</label>
                    <input type="text" class="form-control col-sm-8 col-md-9" id="aadhar">
                </div>

                <div class="form-group row m-0 px-3 mt-3">
                    <button type="button" id="checkUser" class="btn btn-success m-auto">Check user</button>
                </div>
            </form>
        </div>
    </section>

    <section id="warrior" data-applied="warrior">
        <h1 class="section-title bg-dark text-light text-center font-weight-normal">Helpers :</h1>
        <div class="row m-auto">
            <div class="col-sm-6 mb-5">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Special title treatment</h5>
                        <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        var user = JSON.parse(sessionStorage.getItem("myDetails"));
        var userType = user.appliedFor;

        $(window).on('load', () => {
            $('[data-applied]:not(#' + userType + ')').remove();

            $('[data-action]').click(function (event) {
                event.preventDefault();
                sessionStorage.clear();
                localStorage.removeItem("myDetails");
                location.replace('./');
            })

            if (userType === 'warrior') {
                render();
            }
            else {
                $('#checkUser').click(function () {
                    let aadharNo = $('#aadhar').val();
                    let users = JSON.parse(localStorage.getItem("users"));
                    let found = false;

                    for (const [key, value] of Object.entries(users)) {
                        if(value.aadharNo === aadharNo && value.appliedFor === 'warrior'){
                            found = true;
                            break;
                        }
                    }
                    if(found){
                        alert("Customer is a covid warrior");
                    }
                    else{
                        alert("Customer is not genuine");
                    }
                    $(this).closest('form')[0].reset();
                })
            }
        })

        function render() { }
    </script>
</body>

</html>