<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel="shortcut icon" href="imgs/weCayer-logo.png" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>weCayer</title>

    <!-- BOOTSTRAP CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

    <!-- BOOTSTRAP jQuery and JS bundle w/ Popper.js -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
        crossorigin="anonymous"></script>

    <!-- Google fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600&family=Roboto:wght@300;400&family=Courgette&display=swap"
        rel="stylesheet">

    <!-- font swesome -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
        integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!-- jquery -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

    <!-- custom css -->
    <link rel="stylesheet" href="style.css">

</head>

<body>

    <!-- navigation bar -->
    <section class="m-0">
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark flex-column">
            <a class="navbar-brand m-0" href="./">
                <img src="imgs/weCayer-logo.png" height="28px" alt="">
                weCayer
            </a>

            <div>
                <ul class="navbar-nav flex-row">
                    <li class="nav-item mr-5 active">
                        <a class="nav-link" href="">My page</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link pr-0" data-action="logout" href="">Log out</a>
                    </li>
            </div>
        </nav>
    </section>

    <!-- content block -->
    <section id="helper" data-applied="helper">
        <h1 class="section-title bg-dark text-light text-center font-weight-normal">Customer Validation :</h1>
        <div id="contentBlock" class="row flex-column text-light mx-auto col-lg-5 col-md-8 col-sm-10 p-3">
            <h1 class="h1 px-3 mb-5 font-weight-normal text-uppercase text-center">Enter details</h1>
            <form>
                <div class="form-group row m-0 px-3">
                    <label for="aadhar" class="col-sm-4 col-md-3 col-form-label px-0">Aadhar Number</label>
                    <input type="text" class="form-control col-sm-8 col-md-9" id="aadhar">
                </div>

                <div class="form-group row m-0 px-3 mt-3">
                    <button type="button" id="checkUser" class="btn btn-success m-auto">Check user</button>
                </div>
            </form>
        </div>
    </section>

    <section id="warrior" data-applied="warrior">
        <h1 class="section-title bg-dark text-light text-center font-weight-normal">Helpers :</h1>
        <div class="row m-auto">
            <div class="col-sm-6 mb-5">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title font-weight-bold my-0">City</h5>
                    </div>
                    <div class="card-body">
                        <p class="card-text">
                            <span class="font-weight-bold">Helper Name :&nbsp;</span>
                            <span class="spanName">Name</span>
                        </p>
                        <p class="card-text mb-4">
                            <span class="font-weight-bold">Description :&nbsp;</span>
                            <span class="spanDes">description</span>
                        </p>
                        <p class="card-text">
                            <span class="text-success font-weight-bold">
                                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-telephone-fill"
                                    fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M2.267.98a1.636 1.636 0 0 1 2.448.152l1.681 2.162c.309.396.418.913.296 1.4l-.513 2.053a.636.636 0 0 0 .167.604L8.65 9.654a.636.636 0 0 0 .604.167l2.052-.513a1.636 1.636 0 0 1 1.401.296l2.162 1.681c.777.604.849 1.753.153 2.448l-.97.97c-.693.693-1.73.998-2.697.658a17.47 17.47 0 0 1-6.571-4.144A17.47 17.47 0 0 1 .639 4.646c-.34-.967-.035-2.004.658-2.698l.97-.969z" />
                                </svg>
                                Phone Number :&nbsp;
                            </span>
                            <span class="spanPhone">Number</span>
                        </p>
                        <p class="card-text">
                            <span class="text-success font-weight-bold">
                                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-envelope-fill"
                                    fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414.05 3.555zM0 4.697v7.104l5.803-3.558L0 4.697zM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.144l-6.57-4.027L8 9.586l-1.239-.757zm3.436-.586L16 11.801V4.697l-5.803 3.546z" />
                                </svg>
                                Email :&nbsp;
                            </span>
                            <span class="spanMail">mail</span>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        var user = JSON.parse(sessionStorage.getItem("myDetails"));
        var userType = user.appliedFor;

        $(window).on('load', () => {
            $('[data-applied]:not(#' + userType + ')').remove();

            $('[data-action]').click(function (event) {
                event.preventDefault();
                sessionStorage.clear();
                localStorage.removeItem("myDetails");
                location.replace('./');
            })

            if (userType === 'warrior') {
                render();
            }
            else {
                $('#checkUser').click(function () {
                    let aadharNo = $('#aadhar').val();
                    let users = JSON.parse(localStorage.getItem("users"));
                    let found = false;

                    for (const [key, value] of Object.entries(users)) {
                        if (value.aadharNo === aadharNo && value.appliedFor === 'warrior') {
                            found = true;
                            break;
                        }
                    }
                    if (found) {
                        alert("Customer is a covid warrior");
                    }
                    else {
                        alert("Customer is not genuine");
                    }
                    $(this).closest('form')[0].reset();
                })
            }
        })

        function render() {
            let container = $('#warrior .row');
            let users = JSON.parse(localStorage.getItem("users"));
            console.log(users)

            for (const [key, value] of Object.entries(users)) {
                if (value.appliedFor === 'helper') {
                    let cloned = container.children(':first-child').clone();
                    cloned.find(".card-title").text(value.city);
                    cloned.find('.spanName').text(value.name);
                    cloned.find('.spanDes').text(value.service);
                    cloned.find('.spanPhone').text(value.phone);
                    cloned.find('.spanMail').text(value.email);
                    container.append(cloned);
                }
            }
            container.children(':first-child').remove();
        }
    </script>
</body>

</html>